<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>SVT Dream Bank</title>
    <style>
        :root { --rose: #F7CAC9; --serenity: #92A8D1; --text-gray: #8e8e93; }
        body { font-family: -apple-system, system-ui, sans-serif; background: #fdfbfb; margin: 0; padding-bottom: 140px; user-select: none; -webkit-user-select: none; }
        
        /* æ¨™é ­ï¼šé¿é–‹å‹•æ…‹å³¶ */
        .header { background: linear-gradient(to right, var(--rose), var(--serenity)); color: white; padding: 55px 15px 15px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 18px; font-weight: 800; }

        /* ç¸½é¡å¡ç‰‡ */
        .top-card { background: white; margin: 15px; padding: 20px; border-radius: 20px; border: 2.5px solid var(--rose); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .total-val { color: #e84393; font-size: 28px; font-weight: 900; }
        #dateInput { border: none; font-size: 16px; font-weight: bold; color: #666; width: 135px; background: transparent; outline: none; }

        /* å€æ•¸åˆ— */
        .m-bar { background: #f0f0f2; margin: 0 15px 15px; padding: 6px; border-radius: 15px; display: flex; }
        .m-btn { flex: 1; padding: 12px; border: none; background: white; margin: 3px; border-radius: 12px; font-weight: bold; font-size: 16px; color: #555; transition: 0.2s; }
        .m-on { background: var(--serenity); color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        /* æˆå“¡å¡ç‰‡ */
        .member-box { background: white; margin: 15px; padding: 20px; border-radius: 22px; border: 1px solid #efefef; box-shadow: 0 5px 15px rgba(0,0,0,0.04); }
        .member-title { font-size: 19px; font-weight: bold; margin-bottom: 15px; display: flex; align-items: baseline; gap: 8px; }
        .ko-name { font-size: 14px; color: var(--text-gray); font-weight: normal; }
        
        /* æŒ‰éˆ•ç¶²æ ¼ */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .btn { padding: 16px 5px; border-radius: 14px; border: 1px solid #f2f2f2; background: #fff; font-size: 14px; font-weight: 600; color: #444; -webkit-appearance: none; }
        .btn:active { background: #f0f0f0; transform: scale(0.96); }

        /* å¼·åˆ¶é¡è‰²æ¨™ç±¤ */
        .btn-yellow { background-color: #FFF9C4 !important; border-color: #FBC02D !important; color: #F57F17 !important; }
        .btn-purple { background-color: #F3E5F5 !important; border-color: #9C27B0 !important; color: #9C27B0 !important; }

        /* æ˜ç´° */
        .logs { background: #fafafa; margin: 15px; padding: 15px; border-radius: 15px; border: 1px dashed #ddd; }
        .log-line { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f0f0f0; font-size: 14px; }

        /* åº•éƒ¨å°èˆª */
        .footer { position: fixed; bottom: 0; width: 100%; background: rgba(255,255,255,0.92); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); padding: 15px 15px 40px; display: flex; gap: 12px; border-top: 1px solid #eee; box-sizing: border-box; z-index: 9999; }
        .f-btn { flex: 1; padding: 16px; border-radius: 30px; border: none; font-weight: bold; font-size: 16px; }
        .f-on { background: var(--rose); color: white; box-shadow: 0 4px 10px rgba(247,202,201,0.4); }
        .f-off { background: white; border: 1.5px solid var(--serenity); color: var(--serenity); }

        .hidden { display: none; }
    </style>
</head>
<body>

<div class="header"><h1>ğŸ’ 2026 SVT Dream Bank</h1></div>

<div class="top-card">
    <input type="date" id="dateInput" onchange="changeDate()">
    <div class="total-val">$<span id="money">0</span></div>
</div>

<div id="save-page">
    <div class="m-bar">
        <button class="m-btn m-on" onclick="setM(1, this)">1</button>
        <button class="m-btn" onclick="setM(3, this)">3</button>
        <button class="m-btn" onclick="setM(5, this)">5</button>
        <button class="m-btn" onclick="setM(10, this)">10</button>
    </div>
    <div id="m-list"></div>
    <div class="logs">
        <div style="font-weight:bold; color:#999; margin-bottom:10px;">ğŸ“‹ ä»Šæ—¥æ˜ç´°</div>
        <div id="log-list"></div>
    </div>
</div>

<div id="concert-page" class="hidden">
    <div class="member-box" style="border: 2px solid var(--serenity);">
        <h3 style="margin-top:0; color:var(--serenity); text-align:center;">ğŸŸï¸ æ–°å¢æˆå°±æ”¯å‡º</h3>
        <input type="text" id="c-name" placeholder="æ´»å‹•åç¨±" style="width:100%; padding:14px; margin-bottom:10px; border:1px solid #ddd; border-radius:12px; box-sizing:border-box; font-size:16px;">
        <input type="number" id="c-cost" placeholder="æ”¯å‡ºç¸½é‡‘é¡" style="width:100%; padding:14px; margin-bottom:10px; border:1px solid #ddd; border-radius:12px; box-sizing:border-box; font-size:16px;">
        <button onclick="addC()" style="width:100%; padding:16px; background:var(--serenity); color:white; border:none; border-radius:15px; font-weight:bold; font-size:16px;">ç¢ºèªæ‰£æ¬¾</button>
    </div>
    <div id="c-list"></div>
</div>

<div class="footer">
    <button id="n1" class="f-btn f-on" onclick="tab(1)">ğŸ’° å­˜éŒ¢</button>
    <button id="n2" class="f-btn f-off" onclick="tab(2)">ğŸŸï¸ æˆå°±</button>
</div>

<script>
    var currentM = 1;
    var state = { total: 0, currentDate: new Date().toISOString().split('T')[0], allLogs: {}, concertLogs: [] };
    var prices = {
        wonwoo: { w_p: 50, w_m: 20, w_s: 30, w_l: 200, i_p: 50, i_s: 30, i_photo: 50, i_live: 200, extra: 10 },
        others: { w_p: 20, w_m: 10, w_s: 10, w_l: 50, i_p: 20, i_s: 10, i_live: 50, extra: 10 }
    };
    
    // è£œå›éŸ“æ–‡åå­—æ•¸æ“š
    var members = [
        {en:"S.coups", ko:"ìŠ¹ì² "}, {en:"Jeonghan", ko:"ì •í•œ"}, {en:"Joshua", ko:"ì§€ìˆ˜"},
        {en:"Jun", ko:"ì¤€íœ˜"}, {en:"Hoshi", ko:"ìˆœì˜"}, {en:"Wonwoo", ko:"ì›ìš°"},
        {en:"Woozi", ko:"ì§€í›ˆ"}, {en:"The8", ko:"ëª…í˜¸"}, {en:"Mingyu", ko:"ë¯¼ê·œ"},
        {en:"DK", ko:"ì„ë¯¼"}, {en:"Seungkwan", ko:"ìŠ¹ê´€"}, {en:"Vernon", ko:"í•œì†”"},
        {en:"Dino", ko:"ì°¬"}
    ];

    function setM(v, b) {
        currentM = v;
        document.querySelectorAll('.m-btn').forEach(function(x){ x.classList.remove('m-on'); });
        b.classList.add('m-on');
    }

    function tab(p) {
        if(p===1) {
            document.getElementById('save-page').classList.remove('hidden');
            document.getElementById('concert-page').classList.add('hidden');
            document.getElementById('n1').className='f-btn f-on';
            document.getElementById('n2').className='f-btn f-off';
        } else {
            document.getElementById('save-page').classList.add('hidden');
            document.getElementById('concert-page').classList.remove('hidden');
            document.getElementById('n1').className='f-btn f-off';
            document.getElementById('n2').className='f-btn f-on';
            renderC();
        }
    }

    function add(name, act, p) {
        var amt = p * currentM;
        var d = state.currentDate;
        if(!state.allLogs[d]) state.allLogs[d] = [];
        state.allLogs[d].push({ id: Date.now(), amt: amt, text: name + " " + act + (currentM>1?"(x"+currentM+")":"") });
        refresh();
    }

    function live(name, isVip, plat) {
        var p = isVip ? prices.wonwoo : prices.others;
        var n = prompt(name + " " + plat + "ç›´æ’­äººæ•¸ï¼Ÿ", "1");
        if(n) {
            var base = (plat === 'WVS' ? p.w_l : p.i_live);
            var total = parseInt(base) + (parseInt(n)>1 ? (parseInt(n)-1)*p.extra : 0);
            add(name, plat + "ç›´æ’­(" + n + "äºº)", total);
        }
    }

    function refresh() {
        var inc = 0, exp = 0;
        for(var d in state.allLogs) {
            state.allLogs[d].forEach(function(l){ inc += l.amt; });
        }
        state.concertLogs.forEach(function(c){ exp += c.cost; });
        state.total = inc - exp;
        localStorage.setItem('SVT_FINAL_STABLE_V1', JSON.stringify(state));
        updateUI();
    }

    function updateUI() {
        document.getElementById('money').innerText = state.total.toLocaleString();
        document.getElementById('dateInput').value = state.currentDate;
        var logs = state.allLogs[state.currentDate] || [];
        var h = "";
        for(var i=logs.length-1; i>=0; i--) {
            h += '<div class="log-line"><span>'+logs[i].text+' ($'+logs[i].amt+')</span><b style="color:red; padding:5px;" onclick="delL('+logs[i].id+')">âœ–</b></div>';
        }
        document.getElementById('log-list').innerHTML = h || '<div style="color:#ccc;text-align:center;padding:10px;">å°šæœªæœ‰å­˜éŒ¢ç´€éŒ„</div>';
    }

    function delL(id) {
        state.allLogs[state.currentDate] = state.allLogs[state.currentDate].filter(function(l){ return l.id !== id; });
        refresh();
    }

    function addC() {
        var n = document.getElementById('c-name').value;
        var c = parseInt(document.getElementById('c-cost').value) || 0;
        if(!n) return;
        state.concertLogs.push({ id: Date.now(), name: n, cost: c });
        document.getElementById('c-name').value = "";
        document.getElementById('c-cost').value = "";
        refresh();
        renderC();
    }

    function renderC() {
        var h = "";
        for(var i=state.concertLogs.length-1; i>=0; i--) {
            var c = state.concertLogs[i];
            h += '<div class="member-box" style="border-left:6px solid gold;"><b>'+c.name+'</b><span style="color:red;float:right;padding:5px;" onclick="delC('+c.id+')">âœ–</span><br><b style="color:#e84393;font-size:18px;">-$'+c.cost.toLocaleString()+'</b></div>';
        }
        document.getElementById('c-list').innerHTML = h;
    }

    function delC(id) {
        state.concertLogs = state.concertLogs.filter(function(c){ return c.id !== id; });
        refresh();
        renderC();
    }

    function changeDate() { state.currentDate = document.getElementById('dateInput').value; updateUI(); }

    window.onload = function() {
        var saved = localStorage.getItem('SVT_FINAL_STABLE_V1');
        if(saved) state = JSON.parse(saved);
        if(!state.concertLogs) state.concertLogs = [];
        
        var list = document.getElementById('m-list');
        members.forEach(function(m){
            var isVip = (m.en === "Wonwoo");
            var p = isVip ? prices.wonwoo : prices.others;
            var div = document.createElement('div');
            div.className = 'member-box';
            var btns = 
                '<button class="btn" onclick="add(\''+m.en+'\',\'WVSç™¼æ–‡\','+p.w_p+')">WVSç™¼æ–‡</button>' +
                '<button class="btn" onclick="add(\''+m.en+'\',\'WVSç•™è¨€\','+p.w_m+')">WVSç•™è¨€</button>' +
                '<button class="btn" onclick="add(\''+m.en+'\',\'WVSé™å‹•\','+p.w_s+')">WVSé™å‹•</button>' +
                '<button class="btn btn-yellow" onclick="live(\''+m.en+'\','+isVip+',\'WVS\')">WVSç›´æ’­</button>' +
                '<button class="btn" onclick="add(\''+m.en+'\',\'IGç™¼æ–‡\','+p.i_p+')">IGç™¼æ–‡</button>' +
                '<button class="btn" onclick="add(\''+m.en+'\',\'IGé™å‹•\','+p.i_s+')">IGé™å‹•</button>' +
                '<button class="btn btn-yellow" onclick="live(\''+m.en+'\','+isVip+',\'IG\')">IGç›´æ’­</button>';
            if(isVip) btns += '<button class="btn btn-purple" onclick="add(\''+m.en+'\',\'IGæ”å½±å¸³\','+p.i_photo+')">IGæ”å½±å¸³</button>';
            
            // åŠ ä¸ŠéŸ“æ–‡é¡¯ç¤º
            div.innerHTML = '<div class="member-title">' + m.en + ' <span class="ko-name">' + m.ko + '</span> ' + (isVip?'ğŸ’œ':'') + '</div><div class="grid">'+btns+'</div>';
            list.appendChild(div);
        });
        refresh();
    };
</script>
</body>
</html>
