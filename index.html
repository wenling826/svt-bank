<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SVT Dream Bank 2026</title>
    <style>
        /* åŸºç¤è¨­ç½® */
        body { font-family: -apple-system, sans-serif; background-color: #fcfafb; margin: 0; padding-bottom: 120px; -webkit-user-select: none; }
        
        /* é ‚éƒ¨ç²‰è—æ¼¸å±¤ */
        .header { background: linear-gradient(to right, #F7CAC9, #92A8D1); color: white; padding: 20px 15px; text-align: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 18px; letter-spacing: 1px; }

        /* é‡‘é¡èˆ‡æ—¥æœŸå€ */
        .status-bar { background: white; margin: 12px; padding: 18px; border-radius: 15px; border: 2px solid #F7CAC9; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .total-money { color: #e84393; font-size: 26px; font-weight: bold; }
        #dateInput { border: none; font-size: 16px; color: #666; font-weight: bold; width: 130px; }

        /* å€æ•¸åˆ‡æ›å™¨ */
        .multiplier-box { background: #eee; margin: 0 12px 15px; padding: 6px; border-radius: 12px; display: flex; align-items: center; }
        .m-btn { flex: 1; padding: 12px; border: none; background: white; margin: 3px; border-radius: 8px; font-weight: bold; font-size: 16px; color: #555; }
        .m-active { background: #92A8D1; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        /* æˆå“¡å¡ç‰‡æ’ç‰ˆ */
        .member-card { background: white; margin: 15px 12px; padding: 20px; border-radius: 18px; border: 1px solid #eee; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .member-name { font-size: 19px; font-weight: bold; color: #333; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; border-bottom: 1px solid #f5f5f5; padding-bottom: 10px; }
        
        /* æŒ‰éˆ•ç¶²æ ¼ */
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .action-btn { padding: 15px 5px; border-radius: 12px; border: 1px solid #f0f0f0; background: #fff; font-size: 14px; font-weight: 500; color: #555; cursor: pointer; }
        .action-btn:active { background: #f9f9f9; transform: scale(0.96); }

        /* ç‰¹æ®ŠæŒ‰éˆ•é¡è‰² (ç¢ºä¿åœ¨æ‰‹æ©Ÿä¸Šæ¸…æ™°) */
        .btn-live { background-color: #FFF9C4 !important; border-color: #FBC02D !important; color: #F57F17 !important; font-weight: bold; }
        .btn-photo { background-color: #F3E5F5 !important; border-color: #9C27B0 !important; color: #9C27B0 !important; font-weight: bold; }

        /* ç´€éŒ„æ˜ç´° */
        .log-section { background: #fdfdfd; margin: 15px 12px; padding: 15px; border-radius: 15px; border: 1px dashed #ddd; }
        .log-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #eee; font-size: 14px; }

        /* åº•éƒ¨å°èˆª */
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: white; padding: 12px 12px 30px; display: flex; gap: 12px; border-top: 1px solid #eee; z-index: 1000; }
        .nav-item { flex: 1; padding: 16px; border-radius: 30px; border: none; font-weight: bold; font-size: 16px; text-align: center; }
        .nav-active { background: #F7CAC9; color: white; box-shadow: 0 4px 12px rgba(247,202,201,0.5); }
        .nav-inactive { background: white; border: 1px solid #92A8D1; color: #92A8D1; }

        .hidden { display: none; }
        .pop-text { position: absolute; color: #e84393; font-weight: bold; animation: popUp 0.8s ease-out forwards; pointer-events: none; z-index: 2000; }
        @keyframes popUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-40px); } }
    </style>
</head>
<body>

<div class="header"><h1>ğŸ’ 2026 SVT Dream Bank</h1></div>

<div class="status-bar">
    <input type="date" id="dateInput" onchange="changeDate()">
    <div class="total-money">$<span id="displayTotal">0</span></div>
</div>

<div id="page-save">
    <div class="multiplier-box">
        <span style="font-size:12px; color:#888; padding:0 10px;">å€æ•¸</span>
        <button class="m-btn m-active" onclick="setM(1, this)">1</button>
        <button class="m-btn" onclick="setM(3, this)">3</button>
        <button class="m-btn" onclick="setM(5, this)">5</button>
        <button class="m-btn" onclick="setM(10, this)">10</button>
    </div>
    
    <div id="memberList"></div>

    <div class="log-section">
        <div style="font-weight:bold; margin-bottom:10px; color:#999;">ğŸ“‹ ä»Šæ—¥æ˜ç´°</div>
        <div id="logContent"></div>
    </div>
</div>

<div id="page-concert" class="hidden">
    <div class="member-card" style="border: 2px solid #92A8D1;">
        <h3 style="text-align:center; color:#92A8D1; margin-top:0;">ğŸŸï¸ æ–°å¢æ”¯å‡ºç´€éŒ„</h3>
        <input type="text" id="c_name" placeholder="æ¼”å”±æœƒ/æ´»å‹•åç¨±" style="width:100%; padding:12px; margin-bottom:10px; border:1px solid #ddd; border-radius:8px; box-sizing:border-box;">
        <input type="number" id="c_cost" placeholder="æ”¯å‡ºç¸½é‡‘é¡" style="width:100%; padding:12px; margin-bottom:10px; border:1px solid #ddd; border-radius:8px; box-sizing:border-box;">
        <button onclick="addConcert()" style="width:100%; padding:15px; background:#92A8D1; color:white; border:none; border-radius:10px; font-weight:bold;">ç¢ºèªå­˜æª”ä¸¦æ‰£æ¬¾</button>
    </div>
    <div id="concertContent"></div>
</div>

<div class="nav-bar">
    <button id="nav1" class="nav-item nav-active" onclick="showPage(1)">ğŸ’° å­˜éŒ¢</button>
    <button id="nav2" class="nav-item nav-inactive" onclick="showPage(2)">ğŸŸï¸ æˆå°±</button>
</div>

<script>
    // ç‹€æ…‹è®Šæ•¸
    var currentM = 1;
    var state = { total: 0, currentDate: new Date().toISOString().split('T')[0], allLogs: {}, concertLogs: [] };
    
    // åƒ¹æ ¼è¡¨
    var prices = {
        wonwoo: { w_p: 50, w_m: 20, w_s: 30, w_l: 200, i_p: 50, i_s: 30, i_photo: 50, i_live: 200, extra: 10 },
        others: { w_p: 20, w_m: 10, w_s: 10, w_l: 50, i_p: 20, i_s: 10, i_live: 50, extra: 10 }
    };
    var members = ["S.coups", "Jeonghan", "Joshua", "Jun", "Hoshi", "Wonwoo", "Woozi", "The8", "Mingyu", "DK", "Seungkwan", "Vernon", "Dino"];

    // è¨­å®šå€æ•¸
    function setM(val, btn) {
        currentM = val;
        var btns = document.getElementsByClassName('m-btn');
        for(var i=0; i<btns.length; i++) btns[i].classList.remove('m-active');
        btn.classList.add('m-active');
    }

    // åˆ‡æ›é é¢
    function showPage(p) {
        if(p === 1) {
            document.getElementById('page-save').classList.remove('hidden');
            document.getElementById('page-concert').classList.add('hidden');
            document.getElementById('nav1').className = 'nav-item nav-active';
            document.getElementById('nav2').className = 'nav-item nav-inactive';
        } else {
            document.getElementById('page-save').classList.add('hidden');
            document.getElementById('page-concert').classList.remove('hidden');
            document.getElementById('nav1').className = 'nav-item nav-inactive';
            document.getElementById('nav2').className = 'nav-item nav-active';
            renderConcerts();
        }
    }

    // å­˜éŒ¢
    function addMoney(name, act, price, event) {
        var finalAmt = price * currentM;
        var today = state.currentDate;
        if(!state.allLogs[today]) state.allLogs[today] = [];
        
        var label = name + " " + act + (currentM > 1 ? " (x" + currentM + ")" : "");
        state.allLogs[today].push({ id: Date.now(), amt: finalAmt, text: label });
        
        if(event) {
            var rect = event.target.getBoundingClientRect();
            var p = document.createElement('div');
            p.className = 'pop-text';
            p.innerText = "+$" + finalAmt;
            p.style.left = (rect.left + rect.width/2) + "px";
            p.style.top = (rect.top + window.scrollY) + "px";
            document.body.appendChild(p);
            setTimeout(function(){ p.remove(); }, 800);
        }
        refresh();
    }

    // ç›´æ’­è™•ç†
    function handleLive(name, isVip, plat) {
        var p = isVip ? prices.wonwoo : prices.others;
        var n = prompt(name + " " + plat + "ç›´æ’­äººæ•¸ï¼Ÿ", "1");
        if(n && !isNaN(n)) {
            var base = (plat === 'WVS' ? p.w_l : p.i_live);
            var total = parseInt(base) + (parseInt(n) > 1 ? (parseInt(n)-1)*p.extra : 0);
            addMoney(name, plat + "ç›´æ’­(" + n + "äºº)", total);
        }
    }

    // è¨ˆç®—ç¸½é¡
    function refresh() {
        var income = 0;
        var expense = 0;
        for(var d in state.allLogs) {
            state.allLogs[d].forEach(function(l){ income += l.amt; });
        }
        state.concertLogs.forEach(function(c){ expense += c.cost; });
        state.total = income - expense;
        
        localStorage.setItem('SVT_FINAL_STABLE_V1', JSON.stringify(state));
        updateDisplay();
    }

    function updateDisplay() {
        document.getElementById('displayTotal').innerText = state.total.toLocaleString();
        document.getElementById('dateInput').value = state.currentDate;
        var logs = state.allLogs[state.currentDate] || [];
        var html = "";
        for(var i = logs.length-1; i >= 0; i--) {
            html += '<div class="log-row"><span>' + logs[i].text + ' ($' + logs[i].amt + ')</span><b style="color:red;" onclick="delLog(' + logs[i].id + ')">âœ–</b></div>';
        }
        document.getElementById('logContent').innerHTML = html || '<div style="color:#ccc;text-align:center;padding:20px;">ç„¡ç´€éŒ„</div>';
    }

    function delLog(id) {
        state.allLogs[state.currentDate] = state.allLogs[state.currentDate].filter(function(l){ return l.id !== id; });
        refresh();
    }

    // æ¼”å”±æœƒ
    function addConcert() {
        var name = document.getElementById('c_name').value;
        var cost = parseInt(document.getElementById('c_cost').value) || 0;
        if(!name) return;
        state.concertLogs.push({ id: Date.now(), name: name, cost: cost });
        document.getElementById('c_name').value = "";
        document.getElementById('c_cost').value = "";
        refresh();
        renderConcerts();
    }

    function renderConcerts() {
        var html = "";
        for(var i = state.concertLogs.length-1; i >= 0; i--) {
            var c = state.concertLogs[i];
            html += '<div class="member-card" style="border-left:5px solid gold;"><b>' + c.name + '</b><span style="color:red;float:right;" onclick="delC(' + c.id + ')">âœ–</span><br><b style="color:#e84393;font-size:18px;">-$' + c.cost.toLocaleString() + '</b></div>';
        }
        document.getElementById('concertContent').innerHTML = html;
    }

    function delC(id) {
        state.concertLogs = state.concertLogs.filter(function(c){ return c.id !== id; });
        refresh();
        renderConcerts();
    }

    function changeDate() { state.currentDate = document.getElementById('dateInput').value; updateDisplay(); }

    // åˆå§‹åŒ–
    function init() {
        var saved = localStorage.getItem('SVT_FINAL_STABLE_V1');
        if(saved) state = JSON.parse(saved);
        if(!state.concertLogs) state.concertLogs = [];
        
        var list = document.getElementById('memberList');
        members.forEach(function(m){
            var isVip = (m === "Wonwoo");
            var p = isVip ? prices.wonwoo : prices.others;
            var div = document.createElement('div');
            div.className = 'member-card';
            var btns = 
                '<button class="action-btn" onclick="addMoney(\''+m+'\',\'WVSç™¼æ–‡\','+p.w_p+',event)">WVSç™¼æ–‡</button>' +
                '<button class="action-btn" onclick="addMoney(\''+m+'\',\'WVSç•™è¨€\','+p.w_m+',event)">WVSç•™è¨€</button>' +
                '<button class="action-btn" onclick="addMoney(\''+m+'\',\'WVSé™å‹•\','+p.w_s+',event)">WVSé™å‹•</button>' +
                '<button class="action-btn btn-live" onclick="handleLive(\''+m+'\','+isVip+',\'WVS\')">WVSç›´æ’­</button>' +
                '<button class="action-btn" onclick="addMoney(\''+m+'\',\'IGç™¼æ–‡\','+p.i_p+',event)">IGç™¼æ–‡</button>' +
                '<button class="action-btn" onclick="addMoney(\''+m+'\',\'IGé™å‹•\','+p.i_s+',event)">IGé™å‹•</button>' +
                '<button class="action-btn btn-live" onclick="handleLive(\''+m+'\','+isVip+',\'IG\')">IGç›´æ’­</button>';
            if(isVip) btns += '<button class="action-btn btn-photo" onclick="addMoney(\''+m+'\',\'IGæ”å½±å¸³\','+p.i_photo+',event)">IGæ”å½±å¸³</button>';
            
            div.innerHTML = '<div class="member-name">' + m + (isVip?' ğŸ’œ':'') + '</div><div class="btn-grid">' + btns + '</div>';
            list.appendChild(div);
        });
        refresh();
    }
    init();
</script>
</body>
</html>
